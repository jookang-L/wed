# 방명록 구글 스프레드시트 연동 설정 가이드

방명록 기능을 구글 스프레드시트와 연동하기 위한 설정 방법입니다.

## 📋 준비물

- 구글 계정
- 구글 스프레드시트: https://docs.google.com/spreadsheets/d/11SrgtQg8ROlmUBdZOq_W15bgXJKHt4svs0QFaLQm2I0/edit?usp=sharing

## 🚀 설정 단계

### 1단계: 구글 스프레드시트 열기

1. 위 링크로 구글 스프레드시트를 엽니다
2. 시트 이름이 **"시트1"** 인지 확인합니다 (다른 이름이면 `google-apps-script.js`에서 `SHEET_NAME` 수정)

### 2단계: Apps Script 에디터 열기

1. 스프레드시트 상단 메뉴에서 **확장 프로그램 > Apps Script** 클릭
2. 새 Apps Script 프로젝트가 열립니다

### 3단계: 스크립트 코드 복사

1. 프로젝트 루트의 `google-apps-script.js` 파일을 엽니다
2. 전체 코드를 복사합니다
3. Apps Script 에디터의 기본 코드를 모두 삭제하고 복사한 코드를 붙여넣습니다
4. 💾 저장 버튼을 클릭합니다 (Ctrl+S 또는 Cmd+S)

### 4단계: 웹 앱으로 배포

1. 상단 메뉴에서 **배포 > 새 배포** 클릭
2. **유형 선택** 옆의 ⚙️ 아이콘 클릭 → **웹 앱** 선택
3. 다음과 같이 설정:
   - **설명**: "방명록 API" (선택사항)
   - **다음 사용자로 실행**: **나**
   - **액세스 권한이 있는 사용자**: **모든 사용자** ⚠️ 중요!
4. **배포** 버튼 클릭
5. 권한 승인 (⚠️ 경고 화면이 나타날 수 있습니다):
   - "액세스 권한 부여" 클릭
   - 구글 계정 선택
   - **"Google hasn't verified this app"** 경고가 나타납니다 (정상입니다!)
   - **"고급"** (또는 "Hide Advanced") 링크 클릭
   - 하단의 **"Go to [프로젝트명] (unsafe)"** 링크 클릭
   - **"허용"** 클릭
   
   > 💡 이 경고는 정상적인 과정입니다. 본인이 만든 스크립트가 본인의 스프레드시트에 접근하는 것이므로 안전합니다.
6. **웹 앱 URL**이 표시됩니다 → 📋 **복사하기** 클릭

### 5단계: 프론트엔드 코드에 URL 설정

1. `src/components/GuestbookSection.tsx` 파일을 엽니다
2. 9번째 줄의 다음 부분을 찾습니다:

```typescript
const GOOGLE_SCRIPT_URL = "YOUR_GOOGLE_APPS_SCRIPT_URL_HERE";
```

3. 복사한 웹 앱 URL로 변경합니다:

```typescript
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby.../exec";
```

4. 저장합니다

## ✅ 테스트

1. 개발 서버를 실행합니다 (`npm run dev`)
2. 방명록 섹션으로 이동합니다
3. 성함과 메시지를 입력하고 "메시지 남기기" 버튼을 클릭합니다
4. 구글 스프레드시트를 확인하여 메시지가 추가되었는지 확인합니다
5. 페이지를 새로고침하여 메시지가 표시되는지 확인합니다

## 📝 스프레드시트 구조

자동으로 다음과 같은 헤더가 생성됩니다:

| 성함 | 메시지 | 작성일시 |
|------|--------|----------|
| 홍길동 | 축하합니다! | 2026.01.14 |

## 🔧 문제 해결

### "Google hasn't verified this app" 경고가 나타나는 경우

✅ **정상입니다!** 이것은 개인 프로젝트에서 항상 나타나는 경고입니다.

**해결 방법:**
1. "고급" 또는 "Hide Advanced" 클릭
2. "Go to [프로젝트명] (unsafe)" 클릭
3. "허용" 클릭

> 본인의 스크립트가 본인의 스프레드시트에만 접근하므로 안전합니다.

### 메시지가 저장되지 않는 경우

1. Apps Script URL이 올바르게 설정되었는지 확인
2. 배포 시 "모든 사용자" 권한으로 설정했는지 확인
3. 브라우저 콘솔(F12)에서 에러 메시지 확인
4. 권한 승인을 완료했는지 확인

### 메시지가 표시되지 않는 경우

1. 스프레드시트의 시트 이름이 "시트1"인지 확인
2. Apps Script의 `SHEET_NAME` 변수가 올바른지 확인
3. 네트워크 탭에서 API 요청이 성공했는지 확인

### 배포 후 코드 수정 시

1. Apps Script 코드를 수정한 경우
2. **배포 > 배포 관리** 클릭
3. 연필 ✏️ 아이콘 클릭 → **버전** "새 버전" 선택
4. **배포** 클릭
5. URL은 동일하게 유지됩니다 (프론트엔드 코드 수정 불필요)

## 🎉 완료!

이제 방명록이 구글 스프레드시트와 완전히 연동되어 작동합니다!

- 사용자가 메시지를 남기면 즉시 스프레드시트에 저장됩니다
- 다른 사용자들의 메시지도 실시간으로 확인할 수 있습니다
- 모든 메시지는 구글 스프레드시트에서 안전하게 관리됩니다
